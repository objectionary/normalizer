<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BlockArguments #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DuplicateRecordFields #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE InstanceSigs #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE OverloadedRecordDot #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE QuasiQuotes #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE NoImplicitPrelude #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-partial-fields #-}</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.EO.Phi.Report.Html</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.FileEmbed</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">embedFileRelative</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;&amp;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intercalate</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.EO.Phi.Metrics.Data.html"><span class="hs-identifier">Language.EO.Phi.Metrics.Data</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Metrics.Data.html#Metrics"><span class="hs-identifier">Metrics</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.EO.Phi.Metrics.Data.html#MetricsCount"><span class="hs-identifier">MetricsCount</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.EO.Phi.Metrics.Data.html#toListMetrics"><span class="hs-identifier">toListMetrics</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.EO.Phi.Pipeline.Config.html"><span class="hs-identifier">Language.EO.Phi.Pipeline.Config</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.EO.Phi.Report.Data.html"><span class="hs-identifier">Language.EO.Phi.Report.Data</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PyF</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fmt</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Blaze.Html.Renderer.String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">renderHtml</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Blaze.Html5</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">i</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Blaze.Html5</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TBH</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Blaze.Html5.Attributes</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">charset</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">class_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">colspan</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">content</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">id</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">lang</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">onclick</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">type_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">value</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Blaze.Html5.Attributes</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TBHA</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">div</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">id</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">span</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">qualified</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">-- $setup</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- &gt;&gt;&gt; import Text.Blaze.Html.Renderer.String (renderHtml)</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="annot"><span class="hs-comment">-- | JavaScript file to embed into HTML reports</span></span><span>
</span><span id="line-42"></span><span class="annot"><a href="Language.EO.Phi.Report.Html.html#reportJS"><span class="hs-identifier hs-type">reportJS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-43"></span><span id="reportJS"><span class="annot"><span class="annottext">reportJS :: String
</span><a href="Language.EO.Phi.Report.Html.html#reportJS"><span class="hs-identifier hs-var hs-var">reportJS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String) -&gt; Text -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">T.decodeUtf8</span></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">embedFileRelative</span></span><span> </span><span class="annot"><span class="hs-string">&quot;report/main.js&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="annot"><span class="hs-comment">-- | CSS file to embed into HTML reports</span></span><span>
</span><span id="line-46"></span><span class="annot"><a href="Language.EO.Phi.Report.Html.html#reportCSS"><span class="hs-identifier hs-type">reportCSS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-47"></span><span id="reportCSS"><span class="annot"><span class="annottext">reportCSS :: String
</span><a href="Language.EO.Phi.Report.Html.html#reportCSS"><span class="hs-identifier hs-var hs-var">reportCSS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String) -&gt; Text -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">T.decodeUtf8</span></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">embedFileRelative</span></span><span> </span><span class="annot"><span class="hs-string">&quot;report/styles.css&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="annot"><a href="Language.EO.Phi.Report.Html.html#metricsNames"><span class="hs-identifier hs-type">metricsNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Metrics.Data.html#Metrics"><span class="hs-identifier hs-type">Metrics</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-50"></span><span id="metricsNames"><span class="annot"><span class="annottext">metricsNames :: Metrics String
</span><a href="Language.EO.Phi.Report.Html.html#metricsNames"><span class="hs-identifier hs-var hs-var">metricsNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Metrics.Data.html#Metrics"><span class="hs-identifier hs-type">Metrics</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:dataless:Metrics :: String
</span><a href="Language.EO.Phi.Metrics.Data.html#%24sel%3Adataless%3AMetrics"><span class="hs-identifier hs-var">dataless</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Dataless formations&quot;</span></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:applications:Metrics :: String
</span><a href="Language.EO.Phi.Metrics.Data.html#%24sel%3Aapplications%3AMetrics"><span class="hs-identifier hs-var">applications</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Applications&quot;</span></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:formations:Metrics :: String
</span><a href="Language.EO.Phi.Metrics.Data.html#%24sel%3Aformations%3AMetrics"><span class="hs-identifier hs-var">formations</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Formations&quot;</span></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:dispatches:Metrics :: String
</span><a href="Language.EO.Phi.Metrics.Data.html#%24sel%3Adispatches%3AMetrics"><span class="hs-identifier hs-var">dispatches</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Dispatches&quot;</span></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="annot"><a href="Language.EO.Phi.Report.Html.html#toHtmlReportTableHeader"><span class="hs-identifier hs-type">toHtmlReportTableHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Html</span></span><span>
</span><span id="line-59"></span><span id="toHtmlReportTableHeader"><span class="annot"><span class="annottext">toHtmlReportTableHeader :: Html
</span><a href="Language.EO.Phi.Report.Html.html#toHtmlReportTableHeader"><span class="hs-identifier hs-var hs-var">toHtmlReportTableHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">thead</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><span class="annottext">[Html] -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span>
</span><span id="line-62"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">tr</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-63"></span><span>          </span><span class="annot"><span class="annottext">[Html] -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span>
</span><span id="line-64"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">th</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">colspan</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">class_</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;no-sort&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-65"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">th</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">colspan</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;2&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">class_</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;no-sort&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;Attribute&quot;</span></span><span>
</span><span id="line-66"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">th</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">colspan</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;4&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">class_</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;no-sort&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;Change&quot;</span></span><span>
</span><span id="line-67"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">th</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">colspan</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;4&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">class_</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;no-sort&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;Initial&quot;</span></span><span>
</span><span id="line-68"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">th</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">colspan</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;4&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">class_</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;no-sort&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;Normalized&quot;</span></span><span>
</span><span id="line-69"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">th</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">colspan</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;4&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">class_</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;no-sort&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;Location&quot;</span></span><span>
</span><span id="line-70"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-71"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">tr</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; ([Html] -&gt; Html) -&gt; [Html] -&gt; Html
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Html] -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">([Html] -&gt; Html) -&gt; [Html] -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-72"></span><span>          </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">th</span></span><span>
</span><span id="line-73"></span><span>            </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; [Html] -&gt; [Html]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;Test #&quot;</span></span><span>
</span><span id="line-74"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;Attribute Initial&quot;</span></span><span>
</span><span id="line-75"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;Attribute Normalized&quot;</span></span><span>
</span><span id="line-76"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-77"></span><span>              </span><span class="annot"><span class="annottext">[Html] -&gt; [Html] -&gt; [Html]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[[Html]] -&gt; [Html]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-78"></span><span>                    </span><span class="annot"><span class="annottext">([[Html]] -&gt; [Html])
-&gt; ([String] -&gt; [[Html]]) -&gt; [String] -&gt; [Html]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Html] -&gt; [[Html]]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-79"></span><span>                    </span><span class="annot"><span class="annottext">([Html] -&gt; [[Html]])
-&gt; ([String] -&gt; [Html]) -&gt; [String] -&gt; [[Html]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Html) -&gt; [String] -&gt; [Html]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>                    </span><span class="annot"><span class="annottext">([String] -&gt; [Html]) -&gt; [String] -&gt; [Html]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Metrics String -&gt; [String]
forall a. Metrics a -&gt; [a]
</span><a href="Language.EO.Phi.Metrics.Data.html#toListMetrics"><span class="hs-identifier hs-var">toListMetrics</span></a></span><span> </span><span class="annot"><span class="annottext">Metrics String
</span><a href="Language.EO.Phi.Report.Html.html#metricsNames"><span class="hs-identifier hs-var">metricsNames</span></a></span><span>
</span><span id="line-81"></span><span>                 </span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>              </span><span class="annot"><span class="annottext">[Html] -&gt; [Html] -&gt; [Html]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;File Initial&quot;</span></span><span>
</span><span id="line-83"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;Bindings Path Initial&quot;</span></span><span>
</span><span id="line-84"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;File Normalized&quot;</span></span><span>
</span><span id="line-85"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;Bindings Path Normalized&quot;</span></span><span>
</span><span id="line-86"></span><span>                 </span><span class="hs-special">]</span><span>
</span><span id="line-87"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679638218"><span class="annot"><span class="hs-identifier hs-type">ToMarkup</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Pipeline.Config.html#Percent"><span class="hs-identifier hs-type">Percent</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-90"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">toMarkup</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Pipeline.Config.html#Percent"><span class="hs-identifier hs-type">Percent</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Markup</span></span><span>
</span><span id="line-91"></span><span>  </span><span id="local-6989586621679638225"><span class="annot"><span class="annottext">toMarkup :: Percent -&gt; Html
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toMarkup</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toMarkup</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Html) -&gt; (Percent -&gt; String) -&gt; Percent -&gt; Html
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Percent -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679637787"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="ToDataSort"><span class="annot"><a href="Language.EO.Phi.Report.Html.html#ToDataSort"><span class="hs-identifier hs-var">ToDataSort</span></a></span></span><span> </span><span id="local-6989586621679637787"><span class="annot"><a href="#local-6989586621679637787"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>  </span><span id="toDataSort"><span class="annot"><a href="Language.EO.Phi.Report.Html.html#toDataSort"><span class="hs-identifier hs-type">toDataSort</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679637787"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- TODO #389:30m</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- I couldn't make PyF pad doubles with zeros using {n:05} syntax</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- because PyF also counts the digits after .</span><span>
</span><span id="line-99"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Language.EO.Phi.Report.Html.html#ToDataSort"><span class="hs-identifier hs-type">ToDataSort</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Report.Html.html#toDataSort"><span class="hs-identifier hs-type">toDataSort</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-101"></span><span>  </span><span id="local-6989586621679638240"><span class="annot"><span class="annottext">toDataSort :: Double -&gt; Integer
</span><a href="Language.EO.Phi.Report.Html.html#toDataSort"><span class="hs-identifier hs-var hs-var hs-var hs-var">toDataSort</span></a></span></span><span> </span><span id="local-6989586621679638241"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679638241"><span class="hs-identifier hs-var">number</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Integer
forall b. Integral b =&gt; Double -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Integer) -&gt; Double -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679638241"><span class="hs-identifier hs-var">number</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1000</span></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Language.EO.Phi.Report.Html.html#ToDataSort"><span class="hs-identifier hs-type">ToDataSort</span></a></span><span> </span><span class="annot"><a href="Language.EO.Phi.Pipeline.Config.html#Percent"><span class="hs-identifier hs-type">Percent</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Report.Html.html#toDataSort"><span class="hs-identifier hs-type">toDataSort</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Pipeline.Config.html#Percent"><span class="hs-identifier hs-type">Percent</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-105"></span><span>  </span><span id="local-6989586621679638249"><span class="annot"><span class="annottext">toDataSort :: Percent -&gt; Integer
</span><a href="Language.EO.Phi.Report.Html.html#toDataSort"><span class="hs-identifier hs-var hs-var hs-var hs-var">toDataSort</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Pipeline.Config.html#Percent"><span class="hs-identifier hs-type">Percent</span></a></span><span> </span><span id="local-6989586621679638251"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679638251"><span class="hs-identifier hs-var">number</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Integer
forall a. ToDataSort a =&gt; a -&gt; Integer
</span><a href="Language.EO.Phi.Report.Html.html#toDataSort"><span class="hs-identifier hs-var">toDataSort</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679638251"><span class="hs-identifier hs-var">number</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Language.EO.Phi.Report.Html.html#ToDataSort"><span class="hs-identifier hs-type">ToDataSort</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Report.Html.html#toDataSort"><span class="hs-identifier hs-type">toDataSort</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621679638257"><span class="annot"><span class="annottext">toDataSort :: Integer -&gt; Integer
</span><a href="Language.EO.Phi.Report.Html.html#toDataSort"><span class="hs-identifier hs-var hs-var hs-var hs-var">toDataSort</span></a></span></span><span> </span><span id="local-6989586621679638258"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679638258"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679638258"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="annot"><a href="Language.EO.Phi.Report.Html.html#mkDataSortAttribute"><span class="hs-identifier hs-type">mkDataSortAttribute</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AttributeValue</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Attribute</span></span><span>
</span><span id="line-112"></span><span id="mkDataSortAttribute"><span class="annot"><span class="annottext">mkDataSortAttribute :: AttributeValue -&gt; Attribute
</span><a href="Language.EO.Phi.Report.Html.html#mkDataSortAttribute"><span class="hs-identifier hs-var hs-var">mkDataSortAttribute</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tag -&gt; AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">dataAttribute</span></span><span> </span><span class="annot"><span class="annottext">Tag
</span><span class="hs-string">&quot;sort&quot;</span></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">-- &gt;&gt;&gt; pipelineConfig = ReportFormat'Markdown</span><span>
</span><span id="line-115"></span><span class="hs-comment">--</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- &gt;&gt;&gt; renderHtml $ toHtmlChange pipelineConfig (MetricsChange'Bad (Percent 0.2))</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- &quot;&lt;td class=\&quot;number bad\&quot; data-sort=\&quot;1000200\&quot;&gt;20.00%\128308&lt;/td&gt;&quot;</span><span>
</span><span id="line-118"></span><span class="hs-comment">--</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- &gt;&gt;&gt; renderHtml $ toHtmlChange pipelineConfig (MetricsChange'Good (Percent 0.5))</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- &quot;&lt;td class=\&quot;number good\&quot; data-sort=\&quot;1000500\&quot;&gt;50.00%\128994&lt;/td&gt;&quot;</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- &gt;&gt;&gt; renderHtml $ toHtmlChange pipelineConfig (MetricsChange'NA :: MetricsChangeCategory Percent)</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- &quot;&lt;td class=\&quot;number not-applicable\&quot; data-sort=\&quot;0000000\&quot;&gt;N/A\128995&lt;/td&gt;&quot;</span><span>
</span><span id="line-123"></span><span class="annot"><a href="Language.EO.Phi.Report.Html.html#toHtmlChange"><span class="hs-identifier hs-type">toHtmlChange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679637791"><span class="annot"><a href="#local-6989586621679637791"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ToMarkup</span></span><span> </span><span class="annot"><a href="#local-6989586621679637791"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.EO.Phi.Report.Html.html#ToDataSort"><span class="hs-identifier hs-type">ToDataSort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679637791"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Pipeline.Config.html#ReportFormat"><span class="hs-identifier hs-type">ReportFormat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Pipeline.Config.html#MetricsChangeCategory"><span class="hs-identifier hs-type">MetricsChangeCategory</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679637791"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Html</span></span><span>
</span><span id="line-124"></span><span id="toHtmlChange"><span class="annot"><span class="annottext">toHtmlChange :: forall a.
(ToMarkup a, ToDataSort a) =&gt;
ReportFormat -&gt; MetricsChangeCategory a -&gt; Html
</span><a href="Language.EO.Phi.Report.Html.html#toHtmlChange"><span class="hs-identifier hs-var hs-var">toHtmlChange</span></a></span></span><span> </span><span id="local-6989586621679638299"><span class="annot"><span class="annottext">ReportFormat
</span><a href="#local-6989586621679638299"><span class="hs-identifier hs-var">reportFormat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-125"></span><span>  </span><span class="annot"><span class="annottext">MetricsChangeCategory a
</span><a href="Language.EO.Phi.Pipeline.Config.html#MetricsChange%27NA"><span class="hs-identifier hs-var">MetricsChange'NA</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">td</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">class_</span></span><span> </span><span class="annot"><span class="">[fmt|{number} not-applicable|]</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679638306"><span class="hs-identifier hs-var">mkDataSortAttributeNA</span></a></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679638307"><span class="hs-identifier hs-var">na</span></a></span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html -&gt; Html
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&#128995;'</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679638308"><span class="hs-identifier hs-var">isMarkdown</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Pipeline.Config.html#MetricsChange%27Bad"><span class="hs-identifier hs-type">MetricsChange'Bad</span></a></span><span class="hs-special">{</span><span id="local-6989586621679638310"><span class="annot"><span class="annottext">a
change :: a
$sel:change:MetricsChange'Good :: forall a. MetricsChangeCategory a -&gt; a
</span><a href="#local-6989586621679638310"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">td</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">class_</span></span><span> </span><span class="annot"><span class="">[fmt|{number} bad|]</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Attribute
forall {a}. ToDataSort a =&gt; a -&gt; Attribute
</span><a href="#local-6989586621679638312"><span class="hs-identifier hs-var">mkDataSortAttributeChange</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679638310"><span class="hs-identifier hs-var">change</span></a></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679638310"><span class="hs-identifier hs-var">change</span></a></span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html -&gt; Html
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&#128308;'</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679638308"><span class="hs-identifier hs-var">isMarkdown</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Pipeline.Config.html#MetricsChange%27Good"><span class="hs-identifier hs-type">MetricsChange'Good</span></a></span><span class="hs-special">{</span><span id="local-6989586621679638314"><span class="annot"><span class="annottext">a
$sel:change:MetricsChange'Good :: forall a. MetricsChangeCategory a -&gt; a
change :: a
</span><a href="Language.EO.Phi.Pipeline.Config.html#%24sel%3Achange%3AMetricsChange%27Good"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">td</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">class_</span></span><span> </span><span class="annot"><span class="">[fmt|{number} good|]</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Attribute
forall {a}. ToDataSort a =&gt; a -&gt; Attribute
</span><a href="#local-6989586621679638312"><span class="hs-identifier hs-var">mkDataSortAttributeChange</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679638314"><span class="hs-identifier hs-var">change</span></a></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679638314"><span class="hs-identifier hs-var">change</span></a></span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html -&gt; Html
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&#128994;'</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679638308"><span class="hs-identifier hs-var">isMarkdown</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-128"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621679638308"><span class="annot"><span class="annottext">isMarkdown :: Bool
</span><a href="#local-6989586621679638308"><span class="hs-identifier hs-var hs-var">isMarkdown</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReportFormat
</span><a href="#local-6989586621679638299"><span class="hs-identifier hs-var">reportFormat</span></a></span><span> </span><span class="annot"><span class="annottext">ReportFormat -&gt; ReportFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ReportFormat
</span><a href="Language.EO.Phi.Pipeline.Config.html#ReportFormat%27Markdown"><span class="hs-identifier hs-var">ReportFormat'Markdown</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span id="local-6989586621679638312"><span class="annot"><span class="annottext">mkDataSortAttributeChange :: a -&gt; Attribute
</span><a href="#local-6989586621679638312"><span class="hs-identifier hs-var hs-var">mkDataSortAttributeChange</span></a></span></span><span> </span><span id="local-6989586621679638334"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679638334"><span class="hs-identifier hs-var">change</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><a href="Language.EO.Phi.Report.Html.html#mkDataSortAttribute"><span class="hs-identifier hs-var">mkDataSortAttribute</span></a></span><span> </span><span class="annot"><span class="">[fmt|1{toDataSort change:06}|]</span></span><span>
</span><span id="line-131"></span><span>  </span><span id="local-6989586621679638306"><span class="annot"><span class="annottext">mkDataSortAttributeNA :: Attribute
</span><a href="#local-6989586621679638306"><span class="hs-identifier hs-var hs-var">mkDataSortAttributeNA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><a href="Language.EO.Phi.Report.Html.html#mkDataSortAttribute"><span class="hs-identifier hs-var">mkDataSortAttribute</span></a></span><span> </span><span class="annot"><span class="">[fmt|0{(toDataSort (Percent 0.0)):06}|]</span></span><span>
</span><span id="line-132"></span><span>  </span><span class="annot"><a href="#local-6989586621679638307"><span class="hs-identifier hs-type">na</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-133"></span><span>  </span><span id="local-6989586621679638307"><span class="annot"><span class="annottext">na :: String
</span><a href="#local-6989586621679638307"><span class="hs-identifier hs-var hs-var">na</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;N/A&quot;</span></span><span>
</span><span id="line-134"></span><span>  </span><span class="annot"><a href="#local-6989586621679638302"><span class="hs-identifier hs-type">number</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-135"></span><span>  </span><span id="local-6989586621679638302"><span class="annot"><span class="annottext">number :: String
</span><a href="#local-6989586621679638302"><span class="hs-identifier hs-var hs-var">number</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;number&quot;</span></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="annot"><a href="Language.EO.Phi.Report.Html.html#toHtmlMetricsChange"><span class="hs-identifier hs-type">toHtmlMetricsChange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Pipeline.Config.html#ReportFormat"><span class="hs-identifier hs-type">ReportFormat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Pipeline.Config.html#MetricsChangeCategorized"><span class="hs-identifier hs-type">MetricsChangeCategorized</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Html</span></span><span class="hs-special">]</span><span>
</span><span id="line-138"></span><span id="toHtmlMetricsChange"><span class="annot"><span class="annottext">toHtmlMetricsChange :: ReportFormat -&gt; MetricsChangeCategorized -&gt; [Html]
</span><a href="Language.EO.Phi.Report.Html.html#toHtmlMetricsChange"><span class="hs-identifier hs-var hs-var">toHtmlMetricsChange</span></a></span></span><span> </span><span id="local-6989586621679638350"><span class="annot"><span class="annottext">ReportFormat
</span><a href="#local-6989586621679638350"><span class="hs-identifier hs-var">reportFormat</span></a></span></span><span> </span><span id="local-6989586621679638351"><span class="annot"><span class="annottext">MetricsChangeCategorized
</span><a href="#local-6989586621679638351"><span class="hs-identifier hs-var">change</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReportFormat -&gt; MetricsChangeCategory Percent -&gt; Html
forall a.
(ToMarkup a, ToDataSort a) =&gt;
ReportFormat -&gt; MetricsChangeCategory a -&gt; Html
</span><a href="Language.EO.Phi.Report.Html.html#toHtmlChange"><span class="hs-identifier hs-var">toHtmlChange</span></a></span><span> </span><span class="annot"><span class="annottext">ReportFormat
</span><a href="#local-6989586621679638350"><span class="hs-identifier hs-var">reportFormat</span></a></span><span> </span><span class="annot"><span class="annottext">(MetricsChangeCategory Percent -&gt; Html)
-&gt; [MetricsChangeCategory Percent] -&gt; [Html]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">MetricsChangeCategorized -&gt; [MetricsChangeCategory Percent]
forall a. Metrics a -&gt; [a]
</span><a href="Language.EO.Phi.Metrics.Data.html#toListMetrics"><span class="hs-identifier hs-var">toListMetrics</span></a></span><span> </span><span class="annot"><span class="annottext">MetricsChangeCategorized
</span><a href="#local-6989586621679638351"><span class="hs-identifier hs-var">change</span></a></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="annot"><a href="Language.EO.Phi.Report.Html.html#toHtmlMetrics"><span class="hs-identifier hs-type">toHtmlMetrics</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Metrics.Data.html#MetricsCount"><span class="hs-identifier hs-type">MetricsCount</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Html</span></span><span class="hs-special">]</span><span>
</span><span id="line-141"></span><span id="toHtmlMetrics"><span class="annot"><span class="annottext">toHtmlMetrics :: MetricsCount -&gt; [Html]
</span><a href="Language.EO.Phi.Report.Html.html#toHtmlMetrics"><span class="hs-identifier hs-var hs-var">toHtmlMetrics</span></a></span></span><span> </span><span id="local-6989586621679638353"><span class="annot"><span class="annottext">MetricsCount
</span><a href="#local-6989586621679638353"><span class="hs-identifier hs-var">metrics</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-142"></span><span>  </span><span class="annot"><span class="annottext">MetricsCount -&gt; [Int]
forall a. Metrics a -&gt; [a]
</span><a href="Language.EO.Phi.Metrics.Data.html#toListMetrics"><span class="hs-identifier hs-var">toListMetrics</span></a></span><span> </span><span class="annot"><span class="annottext">MetricsCount
</span><a href="#local-6989586621679638353"><span class="hs-identifier hs-var">metrics</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><span class="annottext">[Int] -&gt; (Int -&gt; Html) -&gt; [Html]
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679638354"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679638354"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">td</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">class_</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;number&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><a href="Language.EO.Phi.Report.Html.html#mkDataSortAttribute"><span class="hs-identifier hs-var">mkDataSortAttribute</span></a></span><span> </span><span class="annot"><span class="">[fmt|{x:06}|]</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679638354"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="annot"><a href="Language.EO.Phi.Report.Html.html#toHtmlReportRow"><span class="hs-identifier hs-type">toHtmlReportRow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Pipeline.Config.html#ReportFormat"><span class="hs-identifier hs-type">ReportFormat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Report.Data.html#ReportRow"><span class="hs-identifier hs-type">ReportRow</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Html</span></span><span>
</span><span id="line-146"></span><span id="toHtmlReportRow"><span class="annot"><span class="annottext">toHtmlReportRow :: ReportFormat -&gt; Int -&gt; ReportRow -&gt; Html
</span><a href="Language.EO.Phi.Report.Html.html#toHtmlReportRow"><span class="hs-identifier hs-var hs-var">toHtmlReportRow</span></a></span></span><span> </span><span id="local-6989586621679638356"><span class="annot"><span class="annottext">ReportFormat
</span><a href="#local-6989586621679638356"><span class="hs-identifier hs-var">reportFormat</span></a></span></span><span> </span><span id="local-6989586621679638357"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679638357"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679638358"><span class="annot"><span class="annottext">ReportRow
</span><a href="#local-6989586621679638358"><span class="hs-identifier hs-var">reportRow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-147"></span><span>  </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">tr</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; ([Html] -&gt; Html) -&gt; [Html] -&gt; Html
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Html] -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">([Html] -&gt; Html) -&gt; [Html] -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">td</span></span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; (String -&gt; Html) -&gt; String -&gt; Html
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span>
</span><span id="line-150"></span><span>        </span><span class="annot"><span class="annottext">(String -&gt; Html) -&gt; [String] -&gt; [Html]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="">[fmt|{index}|]</span></span><span>
</span><span id="line-151"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; String
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679638359"><span class="hs-identifier hs-var">na</span></a></span><span> </span><span class="annot"><span class="annottext">ReportRow
</span><a href="#local-6989586621679638358"><span class="hs-identifier hs-var">reportRow</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">attributeInitial</span><span>
</span><span id="line-152"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; String
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679638359"><span class="hs-identifier hs-var">na</span></a></span><span> </span><span class="annot"><span class="annottext">ReportRow
</span><a href="#local-6989586621679638358"><span class="hs-identifier hs-var">reportRow</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">attributeNormalized</span><span>
</span><span id="line-153"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>      </span><span class="annot"><span class="annottext">[Html] -&gt; [Html] -&gt; [Html]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReportFormat -&gt; MetricsChangeCategorized -&gt; [Html]
</span><a href="Language.EO.Phi.Report.Html.html#toHtmlMetricsChange"><span class="hs-identifier hs-var">toHtmlMetricsChange</span></a></span><span> </span><span class="annot"><span class="annottext">ReportFormat
</span><a href="#local-6989586621679638356"><span class="hs-identifier hs-var">reportFormat</span></a></span><span> </span><span class="annot"><span class="annottext">ReportRow
</span><a href="#local-6989586621679638358"><span class="hs-identifier hs-var">reportRow</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">metricsChange</span><span>
</span><span id="line-156"></span><span>      </span><span class="annot"><span class="annottext">[Html] -&gt; [Html] -&gt; [Html]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">MetricsCount -&gt; [Html]
</span><a href="Language.EO.Phi.Report.Html.html#toHtmlMetrics"><span class="hs-identifier hs-var">toHtmlMetrics</span></a></span><span> </span><span class="annot"><span class="annottext">ReportRow
</span><a href="#local-6989586621679638358"><span class="hs-identifier hs-var">reportRow</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">metricsInitial</span><span>
</span><span id="line-157"></span><span>      </span><span class="annot"><span class="annottext">[Html] -&gt; [Html] -&gt; [Html]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">MetricsCount -&gt; [Html]
</span><a href="Language.EO.Phi.Report.Html.html#toHtmlMetrics"><span class="hs-identifier hs-var">toHtmlMetrics</span></a></span><span> </span><span class="annot"><span class="annottext">ReportRow
</span><a href="#local-6989586621679638358"><span class="hs-identifier hs-var">reportRow</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">metricsNormalized</span><span>
</span><span id="line-158"></span><span>      </span><span class="annot"><span class="annottext">[Html] -&gt; [Html] -&gt; [Html]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">td</span></span><span>
</span><span id="line-159"></span><span>            </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; (String -&gt; Html) -&gt; String -&gt; Html
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span>
</span><span id="line-160"></span><span>            </span><span class="annot"><span class="annottext">(String -&gt; Html) -&gt; [String] -&gt; [Html]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; String
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679638360"><span class="hs-identifier hs-var">allPrograms</span></a></span><span> </span><span class="annot"><span class="annottext">ReportRow
</span><a href="#local-6989586621679638358"><span class="hs-identifier hs-var">reportRow</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">fileInitial</span><span>
</span><span id="line-161"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Maybe [String] -&gt; [String]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679638361"><span class="hs-identifier hs-var">wholeProgram</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">ReportRow
</span><a href="#local-6989586621679638358"><span class="hs-identifier hs-var">reportRow</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">bindingsPathInitial</span><span>
</span><span id="line-162"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; String
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679638360"><span class="hs-identifier hs-var">allPrograms</span></a></span><span> </span><span class="annot"><span class="annottext">ReportRow
</span><a href="#local-6989586621679638358"><span class="hs-identifier hs-var">reportRow</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">fileNormalized</span><span>
</span><span id="line-163"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Maybe [String] -&gt; [String]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679638361"><span class="hs-identifier hs-var">wholeProgram</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">ReportRow
</span><a href="#local-6989586621679638358"><span class="hs-identifier hs-var">reportRow</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">bindingsPathNormalized</span><span>
</span><span id="line-164"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-165"></span><span>         </span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-167"></span><span>  </span><span id="local-6989586621679638361"><span class="annot"><span class="annottext">wholeProgram :: String
</span><a href="#local-6989586621679638361"><span class="hs-identifier hs-var hs-var">wholeProgram</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[whole program]&quot;</span></span><span>
</span><span id="line-168"></span><span>  </span><span id="local-6989586621679638360"><span class="annot"><span class="annottext">allPrograms :: String
</span><a href="#local-6989586621679638360"><span class="hs-identifier hs-var hs-var">allPrograms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[all programs]&quot;</span></span><span>
</span><span id="line-169"></span><span>  </span><span id="local-6989586621679638359"><span class="annot"><span class="annottext">na :: String
</span><a href="#local-6989586621679638359"><span class="hs-identifier hs-var hs-var">na</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[N/A]&quot;</span></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="annot"><a href="Language.EO.Phi.Report.Html.html#toHtmlReport"><span class="hs-identifier hs-type">toHtmlReport</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Pipeline.Config.html#ReportFormat"><span class="hs-identifier hs-type">ReportFormat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Pipeline.Config.html#PipelineConfig"><span class="hs-identifier hs-type">PipelineConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Report.Data.html#Report"><span class="hs-identifier hs-type">Report</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Html</span></span><span>
</span><span id="line-172"></span><span id="toHtmlReport"><span class="annot"><span class="annottext">toHtmlReport :: ReportFormat -&gt; PipelineConfig -&gt; Report -&gt; Html
</span><a href="Language.EO.Phi.Report.Html.html#toHtmlReport"><span class="hs-identifier hs-var hs-var">toHtmlReport</span></a></span></span><span> </span><span id="local-6989586621679638366"><span class="annot"><span class="annottext">ReportFormat
</span><a href="#local-6989586621679638366"><span class="hs-identifier hs-var">reportFormat</span></a></span></span><span> </span><span id="local-6989586621679638367"><span class="annot"><span class="annottext">PipelineConfig
</span><a href="#local-6989586621679638367"><span class="hs-identifier hs-var">pipelineConfig</span></a></span></span><span> </span><span id="local-6989586621679638368"><span class="annot"><span class="annottext">Report
</span><a href="#local-6989586621679638368"><span class="hs-identifier hs-var">report</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-173"></span><span>  </span><span class="annot"><span class="annottext">[Html] -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
forall {a}. Monoid a =&gt; a -&gt; a
</span><a href="#local-6989586621679638369"><span class="hs-identifier hs-var">memptyIfMarkdown</span></a></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-identifier hs-var">docType</span></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall {a}. (a -&gt; a) -&gt; a -&gt; a
</span><a href="#local-6989586621679638371"><span class="hs-identifier hs-var">idIfMarkdown</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">TBH.html</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">lang</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;en-US&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-176"></span><span>        </span><span class="annot"><span class="annottext">[Html] -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span>
</span><span id="line-177"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall {a}. (a -&gt; a) -&gt; a -&gt; a
</span><a href="#local-6989586621679638371"><span class="hs-identifier hs-var">idIfMarkdown</span></a></span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">TBH.head</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-178"></span><span>              </span><span class="annot"><span class="annottext">Html -&gt; Html
forall {a}. Monoid a =&gt; a -&gt; a
</span><a href="#local-6989586621679638369"><span class="hs-identifier hs-var">memptyIfMarkdown</span></a></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; ([Html] -&gt; Html) -&gt; [Html] -&gt; Html
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Html] -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">([Html] -&gt; Html) -&gt; [Html] -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-179"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-identifier hs-var">meta</span></span><span> </span><span class="annot"><span class="annottext">Html -&gt; Attribute -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">charset</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;utf-8&quot;</span></span><span>
</span><span id="line-180"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-identifier hs-var">meta</span></span><span> </span><span class="annot"><span class="annottext">Html -&gt; Attribute -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">TBHA.name</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;viewport&quot;</span></span><span> </span><span class="annot"><span class="annottext">Html -&gt; Attribute -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">content</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;width=device-width, initial-scale=1.0&quot;</span></span><span>
</span><span id="line-181"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">TBH.title</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;Report&quot;</span></span><span>
</span><span id="line-182"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- https://stackoverflow.com/a/55743302</span><span>
</span><span id="line-183"></span><span>                  </span><span class="hs-comment">-- https://stackoverflow.com/a/3169849</span><span>
</span><span id="line-184"></span><span>                  </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">script</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">type_</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;text/javascript&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-185"></span><span>                    </span><span class="annot"><span class="">[fmt|
                      function copytable(el) {{
                        var urlField = document.getElementById(el)
                        var range = document.createRange()
                        range.selectNode(urlField)
                        window.getSelection().addRange(range)
                        document.execCommand('copy')

                        if (window.getSelection().empty) {{  // Chrome
                          window.getSelection().empty();
                        }} else if (window.getSelection().removeAllRanges) {{  // Firefox
                          window.getSelection().removeAllRanges();
                        }}
                      }}
                    |]</span></span><span>
</span><span id="line-200"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-201"></span><span>                  </span><span class="annot"><span class="annottext">[Html] -&gt; [Html] -&gt; [Html]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Maybe Html] -&gt; [Html]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span>
</span><span id="line-202"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">PipelineConfig
</span><a href="#local-6989586621679638367"><span class="hs-identifier hs-var">pipelineConfig</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">report</span><span class="hs-operator">.</span><span class="hs-identifier">input</span><span> </span><span class="annot"><span class="annottext">Maybe ReportInput -&gt; (ReportInput -&gt; Maybe String) -&gt; Maybe String
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="hs-operator">.</span><span class="hs-identifier">js</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; (String -&gt; Maybe Html) -&gt; Maybe Html
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679638378"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679638378"><span class="hs-identifier hs-var">js</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Maybe Html
forall a. a -&gt; Maybe a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">script</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679638378"><span class="hs-identifier hs-var">js</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PipelineConfig
</span><a href="#local-6989586621679638367"><span class="hs-identifier hs-var">pipelineConfig</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">report</span><span class="hs-operator">.</span><span class="hs-identifier">input</span><span> </span><span class="annot"><span class="annottext">Maybe ReportInput -&gt; (ReportInput -&gt; Maybe String) -&gt; Maybe String
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="hs-operator">.</span><span class="hs-identifier">css</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; (String -&gt; Maybe Html) -&gt; Maybe Html
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679638379"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679638379"><span class="hs-identifier hs-var">css</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Maybe Html
forall a. a -&gt; Maybe a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">style</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">type_</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;text/css&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679638379"><span class="hs-identifier hs-var">css</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-205"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall {a}. (a -&gt; a) -&gt; a -&gt; a
</span><a href="#local-6989586621679638371"><span class="hs-identifier hs-var">idIfMarkdown</span></a></span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">body</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-206"></span><span>              </span><span class="annot"><span class="annottext">[Html] -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">([Html] -&gt; Html) -&gt; ([[Html]] -&gt; [Html]) -&gt; [[Html]] -&gt; Html
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Html] -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">([Html] -&gt; Html) -&gt; [[Html]] -&gt; [Html]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([[Html]] -&gt; Html) -&gt; [[Html]] -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-207"></span><span>                </span><span class="hs-special">[</span><span>
</span><span id="line-208"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">h2</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;Overview&quot;</span></span><span>
</span><span id="line-209"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">p</span></span><span>
</span><span id="line-210"></span><span>                      </span><span class="annot"><span class="">[fmt|
                        We translate EO files into initial PHI programs.
                        Next, we normalize these programs and get normalized PHI programs.
                        Then, we collect metrics for initial and normalized PHI programs.
                      |]</span></span><span>
</span><span id="line-215"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">h2</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;Metrics&quot;</span></span><span>
</span><span id="line-216"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">p</span></span><span>
</span><span id="line-217"></span><span>                      </span><span class="annot"><span class="">[fmt|
                        An EO file contains multiple test objects.
                        After translation, these test objects become attributes in PHI programs.
                        We call these attributes &quot;tests&quot;.
                      |]</span></span><span>
</span><span id="line-222"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">p</span></span><span>
</span><span id="line-223"></span><span>                      </span><span class="annot"><span class="">[fmt|
                        We collect metrics on the number of {intercalate &quot;, &quot; (toListMetrics metricsNames)} in tests.
                        We want normalized tests to have less such elements than initial tests do.
                      |]</span></span><span>
</span><span id="line-227"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">p</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;A metric change for a test is calculated by the formula&quot;</span></span><span>
</span><span id="line-228"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">p</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">code</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;(metric_initial - metric_normalized) / metric_initial&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">p</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;where:&quot;</span></span><span>
</span><span id="line-230"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">ul</span></span><span>
</span><span id="line-231"></span><span>                      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[Html] -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span>
</span><span id="line-232"></span><span>                          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">li</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">code</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;metric_initial&quot;</span></span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html -&gt; Html
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot; is the metric for the initial test&quot;</span></span><span>
</span><span id="line-233"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">li</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">code</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;metric_normalized&quot;</span></span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html -&gt; Html
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot; is the metric for the normalized test&quot;</span></span><span>
</span><span id="line-234"></span><span>                          </span><span class="hs-special">]</span><span>
</span><span id="line-235"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">h3</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;Expected&quot;</span></span><span>
</span><span id="line-237"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">p</span></span><span> </span><span class="annot"><span class="">[fmt|Metric changes are expected to be as follows or greater:|]</span></span><span>
</span><span id="line-238"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">ul</span></span><span>
</span><span id="line-239"></span><span>                      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[Html] -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">([Html] -&gt; Html)
-&gt; (Metrics Html -&gt; [Html]) -&gt; Metrics Html -&gt; Html
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Metrics Html -&gt; [Html]
forall a. Metrics a -&gt; [a]
</span><a href="Language.EO.Phi.Metrics.Data.html#toListMetrics"><span class="hs-identifier hs-var">toListMetrics</span></a></span><span> </span><span class="annot"><span class="annottext">(Metrics Html -&gt; Html) -&gt; Metrics Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-240"></span><span>                          </span><span class="annot"><span class="annottext">String -&gt; Percent -&gt; Html
</span><a href="Language.EO.Phi.Report.Html.html#mkPercentItem"><span class="hs-identifier hs-var">mkPercentItem</span></a></span><span>
</span><span id="line-241"></span><span>                            </span><span class="annot"><span class="annottext">(String -&gt; Percent -&gt; Html)
-&gt; Metrics String -&gt; Metrics (Percent -&gt; Html)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Metrics String
</span><a href="Language.EO.Phi.Report.Html.html#metricsNames"><span class="hs-identifier hs-var">metricsNames</span></a></span><span>
</span><span id="line-242"></span><span>                            </span><span class="annot"><span class="annottext">Metrics (Percent -&gt; Html) -&gt; Metrics Percent -&gt; Metrics Html
forall a b. Metrics (a -&gt; b) -&gt; Metrics a -&gt; Metrics b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">PipelineConfig
</span><a href="#local-6989586621679638367"><span class="hs-identifier hs-var">pipelineConfig</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">report</span><span class="hs-operator">.</span><span class="hs-identifier">expectedMetricsChange</span><span>
</span><span id="line-243"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">p</span></span><span>
</span><span id="line-245"></span><span>                      </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679638391"><span class="annot"><span class="annottext">expectedImprovedProgramsPercentage :: Percent
</span><a href="#local-6989586621679638391"><span class="hs-identifier hs-var hs-var">expectedImprovedProgramsPercentage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PipelineConfig
</span><a href="#local-6989586621679638367"><span class="hs-identifier hs-var">pipelineConfig</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">report</span><span class="hs-operator">.</span><span class="hs-identifier">expectedImprovedProgramsPercentage</span><span>
</span><span id="line-246"></span><span>                         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="">[fmt|We expect such changes for at least {expectedImprovedProgramsPercentage:s} of tests.|]</span></span><span>
</span><span id="line-247"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">h3</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;Actual&quot;</span></span><span>
</span><span id="line-249"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">p</span></span><span> </span><span class="annot"><span class="">[fmt|We normalized {testsCount} tests.|]</span></span><span>
</span><span id="line-250"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">p</span></span><span> </span><span class="annot"><span class="">[fmt|All metrics were improved for {mkNumber allGoodMetricsCount testsCount} tests.|]</span></span><span>
</span><span id="line-251"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">p</span></span><span> </span><span class="annot"><span class="">[fmt|Tests where a particular metric was improved:|]</span></span><span>
</span><span id="line-252"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">ul</span></span><span>
</span><span id="line-253"></span><span>                      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[Html] -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">([Html] -&gt; Html)
-&gt; (Metrics Html -&gt; [Html]) -&gt; Metrics Html -&gt; Html
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Metrics Html -&gt; [Html]
forall a. Metrics a -&gt; [a]
</span><a href="Language.EO.Phi.Metrics.Data.html#toListMetrics"><span class="hs-identifier hs-var">toListMetrics</span></a></span><span> </span><span class="annot"><span class="annottext">(Metrics Html -&gt; Html) -&gt; Metrics Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-254"></span><span>                          </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Html
</span><a href="#local-6989586621679638398"><span class="hs-identifier hs-var">mkItem'</span></a></span><span>
</span><span id="line-255"></span><span>                            </span><span class="annot"><span class="annottext">(String -&gt; Int -&gt; Html) -&gt; Metrics String -&gt; Metrics (Int -&gt; Html)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Metrics String
</span><a href="Language.EO.Phi.Report.Html.html#metricsNames"><span class="hs-identifier hs-var">metricsNames</span></a></span><span>
</span><span id="line-256"></span><span>                            </span><span class="annot"><span class="annottext">Metrics (Int -&gt; Html) -&gt; MetricsCount -&gt; Metrics Html
forall a b. Metrics (a -&gt; b) -&gt; Metrics a -&gt; Metrics b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">MetricsCount
</span><a href="#local-6989586621679638399"><span class="hs-identifier hs-var">particularMetricsChangeGoodCount</span></a></span><span>
</span><span id="line-257"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">h2</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;Table&quot;</span></span><span>
</span><span id="line-259"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">p</span></span><span> </span><span class="annot"><span class="">[fmt|The table below provides detailed information about tests.|]</span></span><span>
</span><span id="line-260"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-261"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Html] -&gt; [Html]
forall {a}. Monoid a =&gt; a -&gt; a
</span><a href="#local-6989586621679638369"><span class="hs-identifier hs-var">memptyIfMarkdown</span></a></span><span>
</span><span id="line-262"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-identifier hs-var">TBH.input</span></span><span> </span><span class="annot"><span class="annottext">Html -&gt; Attribute -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">type_</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;button&quot;</span></span><span> </span><span class="annot"><span class="annottext">Html -&gt; Attribute -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">value</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;Copy to Clipboard&quot;</span></span><span> </span><span class="annot"><span class="annottext">Html -&gt; Attribute -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">onclick</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;copytable('table')&quot;</span></span><span>
</span><span id="line-263"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">h3</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;Columns&quot;</span></span><span>
</span><span id="line-264"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">p</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;Columns in this table are sortable.&quot;</span></span><span>
</span><span id="line-265"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">p</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;Hover over a header cell from the second row of header cells (Attribute Initial, etc.) to see a triangle demonstrating the sorting order.&quot;</span></span><span>
</span><span id="line-266"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">ul</span></span><span>
</span><span id="line-267"></span><span>                        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[Html] -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span>
</span><span id="line-268"></span><span>                            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">li</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;&#9662;: descending&quot;</span></span><span>
</span><span id="line-269"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">li</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;&#9652;: ascending&quot;</span></span><span>
</span><span id="line-270"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">li</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;&#9656;: unordered&quot;</span></span><span>
</span><span id="line-271"></span><span>                            </span><span class="hs-special">]</span><span>
</span><span id="line-272"></span><span>                        </span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">p</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><span class="hs-string">&quot;Click on the triangle to change the sorting order in the corresponding column.&quot;</span></span><span>
</span><span id="line-274"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-275"></span><span>                </span><span class="hs-special">,</span><span>
</span><span id="line-276"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">table</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">class_</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;sortable&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><span class="hs-string">&quot;table&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-277"></span><span>                      </span><span class="annot"><span class="annottext">[Html] -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span>
</span><span id="line-278"></span><span>                        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Html
</span><a href="Language.EO.Phi.Report.Html.html#toHtmlReportTableHeader"><span class="hs-identifier hs-var">toHtmlReportTableHeader</span></a></span><span>
</span><span id="line-279"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">tbody</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; ([Html] -&gt; Html) -&gt; [Html] -&gt; Html
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Html] -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">([Html] -&gt; Html) -&gt; [Html] -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-280"></span><span>                            </span><span class="annot"><span class="annottext">(Int -&gt; ReportRow -&gt; Html) -&gt; (Int, ReportRow) -&gt; Html
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReportFormat -&gt; Int -&gt; ReportRow -&gt; Html
</span><a href="Language.EO.Phi.Report.Html.html#toHtmlReportRow"><span class="hs-identifier hs-var">toHtmlReportRow</span></a></span><span> </span><span class="annot"><span class="annottext">ReportFormat
</span><a href="#local-6989586621679638366"><span class="hs-identifier hs-var">reportFormat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>                              </span><span class="annot"><span class="annottext">((Int, ReportRow) -&gt; Html) -&gt; [(Int, ReportRow)] -&gt; [Html]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [ReportRow] -&gt; [(Int, ReportRow)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[ReportRow]] -&gt; [ReportRow]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ProgramReport
</span><a href="#local-6989586621679638404"><span class="hs-identifier hs-var">programReport</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">bindingsRows</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679638404"><span class="annot"><span class="annottext">ProgramReport
</span><a href="#local-6989586621679638404"><span class="hs-identifier hs-var">programReport</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Report
</span><a href="#local-6989586621679638368"><span class="hs-identifier hs-var">report</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">programReports</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>                        </span><span class="hs-special">]</span><span>
</span><span id="line-283"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-284"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-285"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-287"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-288"></span><span>  </span><span id="local-6989586621679638406"><span class="annot"><span class="annottext">isMarkdown :: Bool
</span><a href="#local-6989586621679638406"><span class="hs-identifier hs-var hs-var">isMarkdown</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReportFormat
</span><a href="#local-6989586621679638366"><span class="hs-identifier hs-var">reportFormat</span></a></span><span> </span><span class="annot"><span class="annottext">ReportFormat -&gt; ReportFormat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ReportFormat
</span><a href="Language.EO.Phi.Pipeline.Config.html#ReportFormat%27Markdown"><span class="hs-identifier hs-var">ReportFormat'Markdown</span></a></span><span>
</span><span id="line-289"></span><span>  </span><span id="local-6989586621679638371"><span class="annot"><span class="annottext">idIfMarkdown :: (a -&gt; a) -&gt; a -&gt; a
</span><a href="#local-6989586621679638371"><span class="hs-identifier hs-var hs-var">idIfMarkdown</span></a></span></span><span> </span><span id="local-6989586621679638407"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679638407"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679638406"><span class="hs-identifier hs-var">isMarkdown</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">Prelude.id</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679638407"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-290"></span><span>  </span><span id="local-6989586621679638369"><span class="annot"><span class="annottext">memptyIfMarkdown :: a -&gt; a
</span><a href="#local-6989586621679638369"><span class="hs-identifier hs-var hs-var">memptyIfMarkdown</span></a></span></span><span> </span><span id="local-6989586621679638413"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679638413"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679638406"><span class="hs-identifier hs-var">isMarkdown</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679638413"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span>  </span><span id="local-6989586621679638417"><span class="annot"><span class="annottext">tests :: [ReportRow]
</span><a href="#local-6989586621679638417"><span class="hs-identifier hs-var hs-var">tests</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProgramReport -&gt; [ReportRow]) -&gt; [ProgramReport] -&gt; [ReportRow]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-operator">.</span><span class="hs-identifier">bindingsRows</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Report
</span><a href="#local-6989586621679638368"><span class="hs-identifier hs-var">report</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">programReports</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span>  </span><span id="local-6989586621679638395"><span class="annot"><span class="annottext">testsCount :: Int
</span><a href="#local-6989586621679638395"><span class="hs-identifier hs-var hs-var">testsCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ReportRow] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[ReportRow]
</span><a href="#local-6989586621679638417"><span class="hs-identifier hs-var">tests</span></a></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span>  </span><span id="local-6989586621679638426"><span class="annot"><span class="annottext">metricsChanges :: [MetricsChangeCategorized]
</span><a href="#local-6989586621679638426"><span class="hs-identifier hs-var hs-var">metricsChanges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator">.</span><span class="hs-identifier">metricsChange</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ReportRow -&gt; MetricsChangeCategorized)
-&gt; [ReportRow] -&gt; [MetricsChangeCategorized]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(ProgramReport -&gt; [ReportRow]) -&gt; [ProgramReport] -&gt; [ReportRow]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-operator">.</span><span class="hs-identifier">bindingsRows</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Report
</span><a href="#local-6989586621679638368"><span class="hs-identifier hs-var">report</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">programReports</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span>  </span><span id="local-6989586621679638427"><span class="annot"><span class="annottext">isGood :: MetricsChangeCategory a -&gt; Bool
</span><a href="#local-6989586621679638427"><span class="hs-identifier hs-var hs-var">isGood</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-299"></span><span>    </span><span class="annot"><a href="Language.EO.Phi.Pipeline.Config.html#MetricsChange%27Good"><span class="hs-identifier hs-type">MetricsChange'Good</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-300"></span><span>    </span><span class="annot"><span class="annottext">MetricsChangeCategory a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span>  </span><span id="local-6989586621679638431"><span class="annot"><span class="annottext">countAllMetricsSatisfyingCondition :: (MetricsChangeCategory Percent -&gt; Bool) -&gt; Int
</span><a href="#local-6989586621679638431"><span class="hs-identifier hs-var hs-var">countAllMetricsSatisfyingCondition</span></a></span></span><span> </span><span id="local-6989586621679638432"><span class="annot"><span class="annottext">MetricsChangeCategory Percent -&gt; Bool
</span><a href="#local-6989586621679638432"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MetricsChangeCategorized] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">([MetricsChangeCategorized] -&gt; Int)
-&gt; [MetricsChangeCategorized] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(MetricsChangeCategorized -&gt; Bool)
-&gt; [MetricsChangeCategorized] -&gt; [MetricsChangeCategorized]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(MetricsChangeCategory Percent -&gt; Bool)
-&gt; MetricsChangeCategorized -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">MetricsChangeCategory Percent -&gt; Bool
</span><a href="#local-6989586621679638432"><span class="hs-identifier hs-var">cond</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[MetricsChangeCategorized]
</span><a href="#local-6989586621679638426"><span class="hs-identifier hs-var">metricsChanges</span></a></span><span>
</span><span id="line-303"></span><span>  </span><span id="local-6989586621679638396"><span class="annot"><span class="annottext">allGoodMetricsCount :: Int
</span><a href="#local-6989586621679638396"><span class="hs-identifier hs-var hs-var">allGoodMetricsCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MetricsChangeCategory Percent -&gt; Bool) -&gt; Int
</span><a href="#local-6989586621679638431"><span class="hs-identifier hs-var">countAllMetricsSatisfyingCondition</span></a></span><span> </span><span class="annot"><span class="annottext">MetricsChangeCategory Percent -&gt; Bool
forall {a}. MetricsChangeCategory a -&gt; Bool
</span><a href="#local-6989586621679638427"><span class="hs-identifier hs-var">isGood</span></a></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span>  </span><span class="annot"><a href="#local-6989586621679638399"><span class="hs-identifier hs-type">particularMetricsChangeGoodCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Metrics.Data.html#Metrics"><span class="hs-identifier hs-type">Metrics</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-306"></span><span>  </span><span id="local-6989586621679638399"><span class="annot"><span class="annottext">particularMetricsChangeGoodCount :: MetricsCount
</span><a href="#local-6989586621679638399"><span class="hs-identifier hs-var hs-var">particularMetricsChangeGoodCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MetricsCount] -&gt; MetricsCount
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">([MetricsCount] -&gt; MetricsCount) -&gt; [MetricsCount] -&gt; MetricsCount
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679638435"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679638435"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679638435"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Int)
-&gt; (MetricsChangeCategory Percent -&gt; Bool)
-&gt; MetricsChangeCategory Percent
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MetricsChangeCategory Percent -&gt; Bool
forall {a}. MetricsChangeCategory a -&gt; Bool
</span><a href="#local-6989586621679638427"><span class="hs-identifier hs-var">isGood</span></a></span><span> </span><span class="annot"><span class="annottext">(MetricsChangeCategory Percent -&gt; Int)
-&gt; MetricsChangeCategorized -&gt; MetricsCount
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(MetricsChangeCategorized -&gt; MetricsCount)
-&gt; [MetricsChangeCategorized] -&gt; [MetricsCount]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[MetricsChangeCategorized]
</span><a href="#local-6989586621679638426"><span class="hs-identifier hs-var">metricsChanges</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span>  </span><span id="local-6989586621679638398"><span class="annot"><span class="annottext">mkItem' :: String -&gt; Int -&gt; Html
</span><a href="#local-6989586621679638398"><span class="hs-identifier hs-var hs-var">mkItem'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; Int -&gt; Html
</span><a href="Language.EO.Phi.Report.Html.html#mkItem"><span class="hs-identifier hs-var">mkItem</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679638395"><span class="hs-identifier hs-var">testsCount</span></a></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- &gt;&gt;&gt; renderHtml (mkItem 10 &quot;foo&quot; 4)</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- &quot;&lt;li&gt;&lt;b&gt;foo: &lt;/b&gt;4 (40.00%)&lt;/li&gt;&quot;</span><span>
</span><span id="line-313"></span><span class="annot"><a href="Language.EO.Phi.Report.Html.html#mkItem"><span class="hs-identifier hs-type">mkItem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Html</span></span><span>
</span><span id="line-314"></span><span id="mkItem"><span class="annot"><span class="annottext">mkItem :: Int -&gt; String -&gt; Int -&gt; Html
</span><a href="Language.EO.Phi.Report.Html.html#mkItem"><span class="hs-identifier hs-var hs-var">mkItem</span></a></span></span><span> </span><span id="local-6989586621679638437"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679638437"><span class="hs-identifier hs-var">total</span></a></span></span><span> </span><span id="local-6989586621679638438"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679638438"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679638439"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679638439"><span class="hs-identifier hs-var">part</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">li</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">b</span></span><span> </span><span class="annot"><span class="">[fmt|{name}: |]</span></span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html -&gt; Html
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="Language.EO.Phi.Report.Html.html#mkNumber"><span class="hs-identifier hs-var">mkNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679638439"><span class="hs-identifier hs-var">part</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679638437"><span class="hs-identifier hs-var">total</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="annot"><a href="Language.EO.Phi.Report.Html.html#mkPercentItem"><span class="hs-identifier hs-type">mkPercentItem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Pipeline.Config.html#Percent"><span class="hs-identifier hs-type">Percent</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Html</span></span><span>
</span><span id="line-317"></span><span id="mkPercentItem"><span class="annot"><span class="annottext">mkPercentItem :: String -&gt; Percent -&gt; Html
</span><a href="Language.EO.Phi.Report.Html.html#mkPercentItem"><span class="hs-identifier hs-var hs-var">mkPercentItem</span></a></span></span><span> </span><span id="local-6989586621679638441"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679638441"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679638442"><span class="annot"><span class="annottext">Percent
</span><a href="#local-6989586621679638442"><span class="hs-identifier hs-var">percent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">li</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">b</span></span><span> </span><span class="annot"><span class="">[fmt|{name}: |]</span></span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html -&gt; Html
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Percent -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">Percent
</span><a href="#local-6989586621679638442"><span class="hs-identifier hs-var">percent</span></a></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="annot"><a href="Language.EO.Phi.Report.Html.html#mkPercentage"><span class="hs-identifier hs-type">mkPercentage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Pipeline.Config.html#Percent"><span class="hs-identifier hs-type">Percent</span></a></span><span>
</span><span id="line-320"></span><span id="mkPercentage"><span class="annot"><span class="annottext">mkPercentage :: Int -&gt; Int -&gt; Percent
</span><a href="Language.EO.Phi.Report.Html.html#mkPercentage"><span class="hs-identifier hs-var hs-var">mkPercentage</span></a></span></span><span> </span><span id="local-6989586621679638444"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679638444"><span class="hs-identifier hs-var">part</span></a></span></span><span> </span><span id="local-6989586621679638445"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679638445"><span class="hs-identifier hs-var">total</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Percent
</span><a href="Language.EO.Phi.Pipeline.Config.html#Percent"><span class="hs-identifier hs-var">Percent</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Percent) -&gt; Double -&gt; Percent
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679638444"><span class="hs-identifier hs-var">part</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679638445"><span class="hs-identifier hs-var">total</span></a></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- &gt;&gt;&gt; mkNumber 3 5</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- &quot;3 (60.00%)&quot;</span><span>
</span><span id="line-325"></span><span class="annot"><a href="Language.EO.Phi.Report.Html.html#mkNumber"><span class="hs-identifier hs-type">mkNumber</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-326"></span><span id="mkNumber"><span class="annot"><span class="annottext">mkNumber :: Int -&gt; Int -&gt; String
</span><a href="Language.EO.Phi.Report.Html.html#mkNumber"><span class="hs-identifier hs-var hs-var">mkNumber</span></a></span></span><span> </span><span id="local-6989586621679638447"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679638447"><span class="hs-identifier hs-var">part</span></a></span></span><span> </span><span id="local-6989586621679638448"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679638448"><span class="hs-identifier hs-var">total</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[fmt|{part} ({mkPercentage part total:s})|]</span></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="annot"><a href="Language.EO.Phi.Report.Html.html#toStringReport"><span class="hs-identifier hs-type">toStringReport</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Pipeline.Config.html#ReportFormat"><span class="hs-identifier hs-type">ReportFormat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Pipeline.Config.html#PipelineConfig"><span class="hs-identifier hs-type">PipelineConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Report.Data.html#Report"><span class="hs-identifier hs-type">Report</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-329"></span><span id="toStringReport"><span class="annot"><span class="annottext">toStringReport :: ReportFormat -&gt; PipelineConfig -&gt; Report -&gt; String
</span><a href="Language.EO.Phi.Report.Html.html#toStringReport"><span class="hs-identifier hs-var hs-var">toStringReport</span></a></span></span><span> </span><span id="local-6989586621679638450"><span class="annot"><span class="annottext">ReportFormat
</span><a href="#local-6989586621679638450"><span class="hs-identifier hs-var">reportFormat</span></a></span></span><span> </span><span id="local-6989586621679638451"><span class="annot"><span class="annottext">PipelineConfig
</span><a href="#local-6989586621679638451"><span class="hs-identifier hs-var">pipelineConfig</span></a></span></span><span> </span><span id="local-6989586621679638452"><span class="annot"><span class="annottext">Report
</span><a href="#local-6989586621679638452"><span class="hs-identifier hs-var">report</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Html -&gt; String
</span><span class="hs-identifier hs-var">renderHtml</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; String) -&gt; Html -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ReportFormat -&gt; PipelineConfig -&gt; Report -&gt; Html
</span><a href="Language.EO.Phi.Report.Html.html#toHtmlReport"><span class="hs-identifier hs-var">toHtmlReport</span></a></span><span> </span><span class="annot"><span class="annottext">ReportFormat
</span><a href="#local-6989586621679638450"><span class="hs-identifier hs-var">reportFormat</span></a></span><span> </span><span class="annot"><span class="annottext">PipelineConfig
</span><a href="#local-6989586621679638451"><span class="hs-identifier hs-var">pipelineConfig</span></a></span><span> </span><span class="annot"><span class="annottext">Report
</span><a href="#local-6989586621679638452"><span class="hs-identifier hs-var">report</span></a></span><span>
</span><span id="line-330"></span></pre></body></html>